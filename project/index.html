<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--<link rel="stylesheet" href="css/jquery-mobile/jquery-mobile.css">-->
    <!-- grab jquery mobile from a cdn for now -->
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- Movie Details Page -->
    <!-- Used as the page to display details about a movie -->
    <script type="text/template" id="movie-details-template">
      <div data-role="header" data-position="fixed">
        <a href="#" data-role="none" id="back">
          <img src="images/back.png" class="back-button-icon" />
        </a>
        <h1>Details</h1>
        <a href="#" data-role="none" style="text-align: right">
          <% if (isFavorite) { %>
            <img src="images/favorite.png" class="favorite-icon" id="remove_from_fav" />
          <% } else { %>
            <img src="images/not_favorite.png" class="favorite-icon" id="add_to_fav" />
          <% } %>
        </a>
      </div>

      <div role="main" class="ui-content height-100vh">
        <% if (content === 'undefined') { %>
          <div class="card">
            <h3 class="warning center">Something went terribly wrong!</h3>
            <p>We are unable to get the data for you at the moment.</p>
            <div class="center">
              <img src="images/broken.png" />
            </div>
          </div>
        <% } else {
          print(content);
        } %>
      </div>
    </script>
    <!-- /Movie Details Page -->

    <!-- Person Details Page -->
    <script type="text/template" id="person-details-template">
      <div data-role="header" data-position="fixed">
        <a href="#" data-role="none" id="back">
          <img src="images/back.png" class="back-button-icon" />
        </a>
        <h1>Details</h1>
      </div>

      <div role="main" class="ui-content height-100vh">
        <% if (content === 'undefined') { %>
          <div class="card">
            <h3 class="warning center">Something went terribly wrong!</h3>
            <p>We are unable to get the data for you at the moment.</p>
            <div class="center">
              <img src="images/broken.png" />
            </div>
          </div>
        <% } else {
          print(content);
        } %>
      </div>
    </script>
    <!-- /Person Details Page -->

    <!-- Person Details Temlate -->
    <script type="text/template" id="show-person-details-template">
      <div class="card">
        <div class="ui-grid-a">
          <div class="ui-block-a">
            <h2><%= name %></h2>
            <% if (birthday != null && birthday != '') { %>
              <p><b>Date of birth:</b></p>
              <p><%= birthday %></p>
            <% } %>
          </div>
          <div class="ui-block-b">
            <% if (profile_image != null) { %>
              <img src="http://image.tmdb.org/t/p/w500<%= profile_image %>" class="actor_img" />
            <% } else { %>
              <img src="images/actor-alt.png" class="actor_img" /> <%
            }%>
          </div>
        </div>
        <% if (biography != '' && biography != null) { %>
          <p><b>Biography:</b></p> <%
          if (biography.length > 600) { %>
            <p><%= biography.substring(0, 600) %>...</p> <%
          } else { %>
            <p><%= biography %></p> <%
          }
        } %>

        <%
          if (movie_credits.cast.length > 0) { %>
            <div class="center">
            <p><strong>Movies:</strong></p> <%
            if (movie_credits.cast.length > 12) {
              var movies = [];
              for (var i = 0; i < 12; i++) {
                movies[i] = movie_credits.cast[i];
              }
              _.each(movies, function(movie) {
                if (movie.poster_path != null) { %>
                  <a href="#movie/<%= movie.id %>"><img src="http://image.tmdb.org/t/p/w500<%=movie.poster_path%>"
                    class="similar_poster"></img></a> <%
                }
              });
            } else {
              _.each(movie_credits.cast, function(movie) {
                if (movie.poster_path != null) { %>
                  <a href="#movie/<%= movie.id %>"><img src="http://image.tmdb.org/t/p/w500<%=movie.poster_path%>"
                    class="similar_poster"></img></a> <%
                }
              });
            } %>
          </div> <%
          }
        %>
      </div>
    </script>
    <!-- /Person Details Template -->

    <!-- Movie Details Template -->
    <!-- Shows information about a specific movie -->
    <script type="text/template" id="show-movie-details-template">
      <div class="card">
        <div class="ui-grid-a">
          <div class="ui-block-a">
            <h2 class="center"><%= original_title %></h2>
          </div>
          <div class="ui-block-b">
            <% if (poster != null) { %>
              <img src="http://image.tmdb.org/t/p/w500<%= poster %>" class="poster-movie-details" />
            <% } else { %>
              <img src="images/poster-alt.png" class="poster-movie-details" />
            <% } %>
          </div>
        </div>
        <hr>
        <% if (overview != null || overview != 'undefined') { %>
          <h3>Overview:</h3>
          <p><%= overview %></p>
        <% } %>

        <% if (runtime != null || runtime != 'undefined') { %>
          <p><strong>Runtime:</strong> <%= runtime %> min.</p>
        <% } %>

        <% if (release_date != null || release_date != 'undefined') { %>
          <p><strong>Release date:</strong> <%= release_date %></p>
        <% } %>

        <% if (genres.length > 0) {
          var gnrs = '';
          _.each(genres, function(genre) {
            gnrs += genre.name + ', ';
          });
          gnrs = gnrs.slice(0, -2); %>
          <p><strong>Genres: </strong><%= gnrs %></p>
        <% } %>

        <% if (production_companies.length > 0) {
          var prod_comp = '';
          _.each(production_companies, function(company) {
            prod_comp += company.name + ', ';
          });
          prod_comp = prod_comp.slice(0, -2); %>
          <p><strong>Production companies:</strong><br /><%= prod_comp %></p>
        <% } %>

        <% if (production_countries.length > 0) {
          var prod_count = '';
          _.each(production_countries, function(country) {
            prod_count += country.name + ', ';
          });
          prod_count = prod_count.slice(0, -2); %>
          <p><strong>Production countries:</strong><br /><%= prod_count %></p>
        <% } %>

        <% if (credits.cast.length > 0) { %>
            <p><strong>Cast members:</strong></p>
            <ul data-role="listview" class="cast-members-list">
              <% if (credits.cast.length > 5) {
                  var cast = []
                  for (var i = 0; i < 5; i++) {
                    cast[i] = credits.cast[i];
                  }
                  _.each(cast, function(member) { %>
                    <li data-icon="arrow-r" class="ui-alt-icon ui-nodisc-icon"><a href="#person/<%= member.id %>"><%= member.name %></a></li>
                  <% });
                } else {
                  _.each(credits.cast, function(member) { %>
                    <li data-icon="arrow-r" class="ui-alt-icon ui-nodisc-icon"><a href="#person/<%= member.id %>"><%= member.name %></a></li>
                  <% });
                } %>
            </ul>
        <% } %>
        <hr>
        <% if (trailer_source !== 'undefined') { %>
              <p><strong>Trailer</strong></p>
              <div class="center">
                <iframe src="https://youtube.com/embed/<%= trailer_source %>" allowfullscreen></iframe>
              </div>
        <% } %>

        <%
        if (similar.results.length > 0) { %>
          <p><strong>Similar Movies:</strong></p>
          <div class="center"> <%
          if (similar.results.length > 8) {
            var similar_movies = [];
            for (var i = 0; i < 8; i++) {
              similar_movies[i] = similar.results[i];
            }
            _.each(similar_movies, function(movie) {
              if (movie.poster_path != null) { %>
                <a href="#movie/<%= movie.id %>"><img src="http://image.tmdb.org/t/p/w500<%=movie.poster_path%>"
                  class="similar_poster"></img></a> <%
              }
            });
          } else {
            _.each(similar.results, function(movie) {
              if (movie.poster_path != null) { %>
                <a href="#movie/<%= movie.id %>"><img src="http://image.tmdb.org/t/p/w500<%=movie.poster_path%>"
                  class="similar_poster"></img></a> <%
              }
            });
          } %>
        </div> <%
        } %>
      </div>
    </script>
    <!-- /Movie Details Template -->

    <script data-main="js/main" src="js/libs/require/require.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyAAjjxx_UnXEcBOQF2ngFZLq9N5GT_Cf_Q&sensor=false&libraries=places"></script>
  </head>
  <body>
  </body>
</html>
